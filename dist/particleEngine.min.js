/*! particleEngine 23-12-2014 */
!function(a){"use strict";var b=(a.document||{},function(a){function b(a){for(var c=Array.prototype.slice.call(arguments),d=1;d<c.length;d++)for(var e in c[d])c[d].hasOwnProperty(e)&&("object"==typeof c[d][e]&&c[d][e]instanceof Array==!1?(a[e]={},b(a[e],c[d][e])):a[e]=c[d][e]);return a}if("undefined"==typeof a)throw new Error("particles must be defined with a canvas context");var c=a,d={fountain:function(){console.log("fountain")},explosion:function(){console.log("explosion")},stream:function(){console.log("stream")},test:function(){var a=0;if(this.numParticles()<this.properties.max&&this.properties.finished===!1)for(;a++<this.properties.density;)this.addParticle()}},e={snow:{},rain:{},fire:{},ice:{},smoke:{},test:function(){return{direction:5*Math.PI/4+Math.random()*(7*Math.PI/4-5*Math.PI/4),color:[0,0,0],speed:{x:2*Math.random()+2,y:2*Math.random()+2},alpha:1,size:10*Math.random(),decay:Math.sqrt(c.canvas.width*c.canvas.width+c.canvas.height*c.canvas.height)/2}}},f={weight:0,direction:0,position:{x:0,y:0},speed:{x:0,y:0},color:"",size:{height:0,width:0},sprite:!1,shape:!1,alpha:0,decay:0},g={max:500,density:1,finished:!1,stopped:!1},h=function(a,h){if("undefined"==typeof a)throw new Error("Emitter needs to be passed to a collection");var i=e[a.getParticle],j=(a.properties,d[a.behavior]),k=[],l=b({},g,h);return{__testReturnArr:function(){return k},arr:k,properties:l,emitter:a,emitterFunction:j,addParticle:function(a){if(this.properties.stopped===!1){a=a||{};var c=b({},f,i(),a);c.position.x=this.emitter.properties.origin.x,c.position.y=this.emitter.properties.origin.y,k.push(c)}},numParticles:function(){return k.length},draw:function(){this.emitterFunction();var b,d=0;for(k.length;b=k[d];d++){b.position.x+=b.speed.x*Math.cos(b.direction),b.position.y-=b.speed.y*Math.sin(b.direction);var e=b.position.x-a.properties.origin.x,f=b.position.y-a.properties.origin.y,g=Math.sqrt(e*e+f*f);b.alpha=1-g/b.decay,b.alpha<=0&&k.splice(d,1),c.fillStyle="rgba("+b.color.join()+","+b.alpha+")",c.beginPath(),c.arc(b.position.x,b.position.y,b.size,0,2*Math.PI,!0),c.closePath(),c.fill()}}}},i=function(a,c,f){var g,h,i={origin:{x:0,y:0},height:0,width:0};if(b({},i,f),"string"==typeof a){if(g=a,"undefined"==typeof e[a])throw new Error(a+" Does not exist")}else{if("undefined"==typeof a)throw new Error("Undefined particle type");g=a}if("string"==typeof c){if(h=c,"undefined"==typeof d[c])throw new Error(c+" Does not exist")}else{if("undefined"==typeof c||"function"!==c)throw new Error("Undefined emitter function");h=c}return{properties:i,getParticle:g,behavior:h,setOrigin:function(a,b){this.properties.origin.x=a,this.properties.origin.y=b}}};return{collection:h,emitter:i,updateContext:function(a){c=a}}});b.VERSION="0.1.0",a.particles=b}(this);