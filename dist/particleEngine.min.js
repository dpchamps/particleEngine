/*! particleEngine 26-12-2014 */
!function(a){"use strict";var b=(a.document||{},function(b){function c(a){for(var b=Array.prototype.slice.call(arguments),d=1;d<b.length;d++)for(var e in b[d])b[d].hasOwnProperty(e)&&("object"==typeof b[d][e]&&b[d][e]instanceof Array==!1?(a[e]=a[e]||{},c(a[e],b[d][e])):a[e]=b[d][e]);return a}function d(a){var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return b?{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)}:null}function e(a,b){return a+Math.random()*(b-a)}function f(a){if(a.direction=e(a.direction,a.spread),a.speed.x+=Math.random()*a.speed.spread,a.speed.y+=Math.random()*a.speed.spread,a.size.x+=Math.random()*a.size.spread,a.size.y+=Math.random()*a.size.spread,"string"==typeof a.color){var b=d(a.color);a.color=[b.r,b.g,b.b]}return a.color=a.color.map(Math.floor),a}if("undefined"==typeof b)throw new Error("particles must be defined with a canvas context");var g=b,h={flame:{weight:0,direction:1.8016922886691076,spread:1.1780295733605703,position:{x:0,y:0},speed:{x:.6,y:.6,spread:1.6},gravity:0,gravityCount:0,color:[250,117.64705882352948,0],size:{height:0,width:0,spread:2,x:2.5,y:2},sprite:!1,shape:!1,alpha:1,decay:48},water:{weight:0,direction:2.286763289464637,spread:2.286763289464637,position:{x:0,y:0},speed:{x:2.4,y:2.8,spread:2},gravity:9,gravityCount:0,color:[43.627450980392155,138.32468281430226,222.5],size:{height:0,width:0,spread:3.4439461883408073,x:8.035874439461884,y:2.244826376709926},sprite:!1,shape:!1,alpha:1,decay:388},smoke:{weight:0,direction:1.1780295733605703,spread:1.8016922886691076,position:{x:0,y:0},speed:{x:.79,y:.6,spread:.4},gravity:0,gravityCount:0,color:[23.455882352941163,25.596885813148777,27.499999999999986],size:{height:0,width:0,spread:3.3672395650648896,x:2.244826376709926,y:1.122413188354963},sprite:!1,shape:!1,alpha:.24263312079958643,decay:295},explode:{weight:0,direction:0,spread:6.283185307179586,position:{x:0,y:0},speed:{x:5,y:3,spread:3},gravity:1,gravityCount:0,color:[255,65,65],size:{x:4,y:1,spread:5},sprite:!1,shape:!1,alpha:1,decay:228},snow:{weight:0,direction:3.949863863620736,spread:5.474372723263827,position:{x:0,y:0},speed:{x:.6,y:.6,spread:.4},gravity:0,gravityCount:0,color:"#ffffff",size:{height:0,width:0,spread:2,x:2.5,y:2},sprite:!1,shape:!1,alpha:1,decay:449}},i={weight:0,direction:0,spread:0,position:{x:0,y:0},speed:{x:0,y:0,spread:0},gravity:0,gravityCount:0,color:[],size:{height:0,width:0,spread:0},sprite:!1,shape:!1,alpha:0,decay:0},j={max:100,density:1,cycleOnce:!1,cycleCount:0,finished:!1,stopped:!1},k=function(b,d){if("undefined"==typeof b)throw new Error("Emitter needs to be passed to a collection");var h=[],k=c({},j,d);return{properties:k,emitter:b,exportParticle:function(){return a.JSON.stringify(this.emitter.particle)},cycle:function(){var a=0;if(this.numParticles()<this.properties.max&&this.properties.finished===!1)for(;a++<this.properties.density;)this.properties.cycleOnce&&this.properties.cycleCount++,this.addParticle(),this.properties.cycleCount>=this.properties.max&&this.properties.cycleOnce&&(this.properties.finished=!0)},reset:function(){h=[],g.clearRect(0,0,g.canvas.width,g.canvas.height),this.properties.finished=!1,this.properties.cycleCount=0},addParticle:function(){if(this.properties.stopped===!1){var a=c({},i,b.particle);a=f(a);var d={x:e(b.properties.origin.x,b.properties.origin.x+b.properties.width),y:e(b.properties.origin.y,b.properties.origin.y+b.properties.height)};c(a.position,d),h.push(a)}},numParticles:function(){return h.length},draw:function(){this.cycle();var a,c=0;for(h.length;a=h[c];c++){a.position.x+=a.speed.x*Math.cos(a.direction),a.position.y-=a.speed.y*Math.sin(a.direction),a.gravityCount<a.gravity&&(a.gravityCount+=.025*a.gravity),a.position.y+=a.gravityCount;var d=a.position.x-(b.properties.origin.x+b.properties.width),e=a.position.y-(b.properties.origin.y+b.properties.height),f=Math.sqrt(d*d+e*e),i=a.alpha-f/a.decay;0>=i&&h.splice(c,1),g.fillStyle="rgba("+a.color.join()+","+i+")",g.beginPath(),g.arc(a.position.x,a.position.y,a.size.x*a.size.y/2,0,2*Math.PI,!0),g.closePath(),g.fill()}}}},l=function(a,b){var d,e,f={origin:{x:0,y:0},height:1,width:1};c({},f,b);var g=function(a){if("string"==typeof a){if(d=h[a],"undefined"==typeof h[a])throw new Error(a+" Does not exist")}else{if("undefined"==typeof a)throw new Error("Undefined particle type");d=a}e=c({},i,d)};return g(a),{properties:f,particle:e,setOrigin:function(a,b){this.properties.origin.x=a,this.properties.origin.y=b},setParticle:function(a){g(a),c(this.particle,e)}}};return{collection:k,emitter:l,updateContext:function(a){g=a}}});b.VERSION="0.2.0",a.particles=b}(this);