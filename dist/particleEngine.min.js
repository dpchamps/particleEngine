/*! particleEngine 23-12-2014 */
!function(a){"use strict";var b=(a.document||{},function(a){function b(a){for(var c=Array.prototype.slice.call(arguments),d=1;d<c.length;d++)for(var e in c[d])c[d].hasOwnProperty(e)&&("object"==typeof c[d][e]&&c[d][e]instanceof Array==!1?(a[e]={},b(a[e],c[d][e])):a[e]=c[d][e]);return a}function c(a){var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return b?{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)}:null}if("undefined"==typeof a)throw new Error("particles must be defined with a canvas context");var d=a,e={fountain:function(){console.log("fountain")},explosion:function(){console.log("explosion")},stream:function(){console.log("stream")},test:function(){var a=0;if(this.numParticles()<this.properties.max&&this.properties.finished===!1)for(;a++<this.properties.density;)this.addParticle()}},f={snow:{},rain:{},fire:{},ice:{},smoke:{},test:function(){return{direction:5*Math.PI/4+Math.random()*(7*Math.PI/4-5*Math.PI/4),color:[0,0,0],speed:{x:2*Math.random()+2,y:2*Math.random()+2},alpha:1,size:10*Math.random(),decay:Math.sqrt(d.canvas.width*d.canvas.width+d.canvas.height*d.canvas.height)/2}}},g={weight:0,direction:0,position:{x:0,y:0},speed:{x:0,y:0},color:"",size:{height:0,width:0},sprite:!1,shape:!1,alpha:0,decay:0},h={max:100,density:1,finished:!1,stopped:!1},i=function(a,i){if("undefined"==typeof a)throw new Error("Emitter needs to be passed to a collection");var j=f[a.getParticle],k=(a.properties,e[a.behavior]),l=[],m=b({},h,i),n={color:[17,80.00009,90],size:5,direction:1,decay:Math.sqrt(d.canvas.width*d.canvas.width+d.canvas.height*d.canvas.height)/2,spread:0,speed:{x:2*Math.random()+2,y:2*Math.random()+2},speedVariation:1,alpha:1};return{__testReturnArr:function(){return l},arr:l,properties:m,emitter:a,emitterFunction:k,addParticle:function(d){if(this.properties.stopped===!1){d=d||{};var e=b({},g,j(),d),f=1,h=1,i=a.properties.width,k=a.properties.height,m={x:a.properties.origin.x*f+Math.random()*(i-f),y:a.properties.origin.y*h+Math.random()*(k-h)};if(b(e.position,m),b(e,n),e.direction+=Math.random()*e.spread,e.speed.x+=Math.random()*e.speedVariation,e.speed.y+=Math.random()*e.speedVariation,"string"==typeof e.color){var o=c(e.color);e.color=[o.r,o.g,o.b]}e.color=e.color.map(Math.floor),l.push(e)}},clusterOverrides:n,numParticles:function(){return l.length},draw:function(){this.emitterFunction();var b,c=0;for(l.length;b=l[c];c++){b.position.x+=b.speed.x*Math.cos(b.direction),b.position.y-=b.speed.y*Math.sin(b.direction);var e=b.position.x-a.properties.origin.x,f=b.position.y-a.properties.origin.y,g=Math.sqrt(e*e+f*f);b.alpha=1-g/b.decay,b.alpha<=0&&l.splice(c,1),d.fillStyle="rgba("+b.color.join()+","+b.alpha+")",d.beginPath(),d.arc(b.position.x,b.position.y,b.size,0,2*Math.PI,!0),d.closePath(),d.fill()}}}},j=function(a,c,d){var g,h,i={origin:{x:0,y:0},height:1,width:1};if(b({},i,d),"string"==typeof a){if(g=a,"undefined"==typeof f[a])throw new Error(a+" Does not exist")}else{if("undefined"==typeof a)throw new Error("Undefined particle type");g=a}if("string"==typeof c){if(h=c,"undefined"==typeof e[c])throw new Error(c+" Does not exist")}else{if("undefined"==typeof c||"function"!==c)throw new Error("Undefined emitter function");h=c}return{properties:i,getParticle:g,behavior:h,setOrigin:function(a,b){this.properties.origin.x=a,this.properties.origin.y=b}}};return{collection:i,emitter:j,updateContext:function(a){d=a}}});b.VERSION="0.1.0",a.particles=b}(this);